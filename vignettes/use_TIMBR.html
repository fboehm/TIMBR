<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Getting Started with TIMBR</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting Started with TIMBR</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>TIMBR is an R package for inferring an allelic series of haplotypes at a locus in a multiparental population. This vignette demonstrates how to get started using data from the first example in the <a href="https://www.biorxiv.org/content/10.1101/2020.05.23.112326v2">manuscript</a>.</p>
</div>
<div id="installing-from-github" class="section level2">
<h2>Installing from GitHub</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;wesleycrouse/TIMBR&quot;</span>)</a></code></pre></div>
</div>
<div id="loading-the-package-and-example-data" class="section level2">
<h2>Loading the package and example data</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(TIMBR)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">data</span>(mcv.data)</a></code></pre></div>
</div>
<div id="formatting-data" class="section level2">
<h2>Formatting data</h2>
<p>The input data for TIMBR includes a vector <code>y</code> of quantitative trait observations</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">y &lt;-<span class="st"> </span>mcv.data<span class="op">$</span>y</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">head</span>(y, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>##  [1] 44.6 48.5 46.3 61.5 47.0 60.9 51.7 51.4 55.1 70.5</code></pre>
<p>and a list <code>prior.D</code> which specifies prior haplotype-pair (diplotype) state probabilities.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">prior.D &lt;-<span class="st"> </span>mcv.data<span class="op">$</span>prior.D</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">str</span>(prior.D)</a></code></pre></div>
<pre><code>## List of 3
##  $ P          : num [1:131, 1:36] 3.33e-08 1.12e-04 1.45e-05 1.00e-02 3.68e-08 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:36] &quot;AA&quot; &quot;BB&quot; &quot;CC&quot; &quot;DD&quot; ...
##  $ A          : num [1:36, 1:8] 1 0 0 0 0 0 0 0 0.5 0.5 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:36] &quot;AA&quot; &quot;BB&quot; &quot;CC&quot; &quot;DD&quot; ...
##   .. ..$ : chr [1:8] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##  $ fixed.diplo: logi FALSE</code></pre>
<p><code>prior.D</code> includes a matrix of diplotype state probabilities <code>P</code> for all individuals and an additive design matrix <code>A</code> that maps diplotype states to half-counts of haplotype dosages. The option <code>fixed.diplo=TRUE</code> fixes each diplotype state to its prior maximum to speed computation. In this example, there are 131 individuals, 36 possible diplotype states, 8 different haplotypes, and diplotype states will be sampled rather than fixed.</p>
<p>The order of rows in <code>P</code> must match the order of observations in <code>y</code>. When inputting your own data, make sure that <code>A</code> is correctly specified to match the order of columns in <code>P</code>. Here, the columns in <code>P</code> (and consequently, the rows in <code>A</code>) use the default order in ‘HAPPY’. For example, the first rows of <code>A</code> are:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">prior.D<span class="op">$</span>A[<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>,]</a></code></pre></div>
<pre><code>##      A   B   C   D E F G H
## AA 1.0 0.0 0.0 0.0 0 0 0 0
## BB 0.0 1.0 0.0 0.0 0 0 0 0
## CC 0.0 0.0 1.0 0.0 0 0 0 0
## DD 0.0 0.0 0.0 1.0 0 0 0 0
## EE 0.0 0.0 0.0 0.0 1 0 0 0
## FF 0.0 0.0 0.0 0.0 0 1 0 0
## GG 0.0 0.0 0.0 0.0 0 0 1 0
## HH 0.0 0.0 0.0 0.0 0 0 0 1
## AB 0.5 0.5 0.0 0.0 0 0 0 0
## AC 0.5 0.0 0.5 0.0 0 0 0 0
## BC 0.0 0.5 0.5 0.0 0 0 0 0
## AD 0.5 0.0 0.0 0.5 0 0 0 0
## BD 0.0 0.5 0.0 0.5 0 0 0 0
## CD 0.0 0.0 0.5 0.5 0 0 0 0</code></pre>
<p>The default order in ‘qtl2’ is different. To generate an additive design matrix for use with ‘qtl2’ data, use the function <code>additive.design</code>. The row and column names in <code>P</code> and <code>A</code> are for clarity; they are not used by TIMBR.</p>
</div>
<div id="haplotype-based-association" class="section level2">
<h2>Haplotype-based association</h2>
<p>TIMBR requires a prior distribution for the allelic series. To begin, we implement a standard haplotype-based association model that assumes the allelic series is known and that all haplotypes are functionally distinct from one another.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">prior.M.hap &lt;-<span class="st"> </span>mcv.data<span class="op">$</span>prior.M<span class="op">$</span>fixed</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">str</span>(prior.M.hap)</a></code></pre></div>
<pre><code>## List of 2
##  $ model.type: chr &quot;fixed&quot;
##  $ M.IDs     : chr &quot;0,1,2,3,4,5,6,7&quot;</code></pre>
<p><code>prior.M</code> is a list where <code>model.type=&quot;fixed&quot;</code> specifies that the allelic series is fixed to a single value, and <code>M.IDs=&quot;0,1,2,3,4,5,6,7&quot;</code>specifies an allelic series where all 8 haplotypes are functionally distinct.</p>
<p>We call TIMBR using this prior and visualize the haplotype effects.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">results.hap &lt;-<span class="st"> </span><span class="kw">TIMBR</span>(y, prior.D, prior.M.hap, <span class="dt">verbose=</span>F, <span class="dt">samples=</span><span class="dv">100</span>, <span class="dt">samples.ml=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">TIMBR.plot.haplotypes</span>(results.hap)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We also report the natural log Bayes factor (lnBF) in favor of this model against a null where all haplotypes are functionally identical (i.e. there is no genetic effet).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">results.hap<span class="op">$</span>ln.BF</a></code></pre></div>
<pre><code>## [1] 30.21494</code></pre>
</div>
<div id="setting-the-allelic-series-to-a-specific-value" class="section level2">
<h2>Setting the allelic series to a specific value</h2>
<p>Based on the previous result, it may be reasonable to assume that the allelic series is actually biallelic, with one functional allele comprised of haplotypes B,D,E and the other allele comprised of the other haplotypes. We can specify this allelic series similarly.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">prior.M.biallelic &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model.type=</span><span class="st">&quot;fixed&quot;</span>, </a>
<a class="sourceLine" id="cb14-2" title="2">                          <span class="dt">M.IDs=</span><span class="st">&quot;0,1,0,1,1,0,0,0&quot;</span>)</a></code></pre></div>
<p>We call TIMBR assuming this biallelic contrast, report the first ten posterior samples of the haplotype effects, and visualize the haplotype effects against the previous haplotype-based model.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">results.biallelic &lt;-<span class="st"> </span><span class="kw">TIMBR</span>(y, prior.D, prior.M.biallelic, <span class="dt">verbose=</span>F, <span class="dt">samples=</span><span class="dv">100</span>, <span class="dt">samples.ml=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">results.biallelic<span class="op">$</span>post.hap.effects[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a></code></pre></div>
<pre><code>##           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
##  [1,] 58.26668 47.43422 58.26668 47.43422 47.43422 58.26668 58.26668 58.26668
##  [2,] 58.85404 46.70656 58.85404 46.70656 46.70656 58.85404 58.85404 58.85404
##  [3,] 59.04382 46.97495 59.04382 46.97495 46.97495 59.04382 59.04382 59.04382
##  [4,] 59.41665 47.34438 59.41665 47.34438 47.34438 59.41665 59.41665 59.41665
##  [5,] 59.58320 48.39316 59.58320 48.39316 48.39316 59.58320 59.58320 59.58320
##  [6,] 58.84350 47.83800 58.84350 47.83800 47.83800 58.84350 58.84350 58.84350
##  [7,] 59.44083 47.25821 59.44083 47.25821 47.25821 59.44083 59.44083 59.44083
##  [8,] 59.19858 47.80149 59.19858 47.80149 47.80149 59.19858 59.19858 59.19858
##  [9,] 60.04622 47.59711 60.04622 47.59711 47.59711 60.04622 60.04622 60.04622
## [10,] 59.97801 48.04083 59.97801 48.04083 48.04083 59.97801 59.97801 59.97801</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">TIMBR.plot.haplotypes</span>(results.biallelic, <span class="dt">TIMBR.output.bkgrd=</span>results.hap)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The posterior samples show that haplotype effects are now identical within alleles. The visualization shows that they are also estimated with more certainty because there are fewer effect parameters (two) than in the haplotype-based model (eight). We also calculate the lnBF in favor of this biallelic model against the previous haplotype-based model.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">results.biallelic<span class="op">$</span>ln.BF <span class="op">-</span><span class="st"> </span>results.hap<span class="op">$</span>ln.BF</a></code></pre></div>
<pre><code>## [1] 7.465594</code></pre>
<p>In this way, TIMBR can be used for a fully-Bayesian implementaiton of merge analysis. See the manuscript for more details.</p>
</div>
<div id="modeling-the-allelic-series-with-a-uniform-prior-distribution" class="section level2">
<h2>Modeling the allelic series with a uniform prior distribution</h2>
<p>Often, we do not expect all haplotypes to be functionally distint, but we also do not know the correct allelic series configuration with certainty. Using TIMBR, we can set a prior distribution over all possible allelic series configurations and estimate a posterior distribution. A naive first approach is to assume a uniform distribution where all allelic series are equally likely <em>a priori</em>. This is specifed as</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">prior.M.uniform &lt;-<span class="st"> </span>mcv.data<span class="op">$</span>prior.M<span class="op">$</span>uniform</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">str</span>(prior.M.uniform)</a></code></pre></div>
<pre><code>## List of 1
##  $ model.type: chr &quot;uniform&quot;</code></pre>
<p>We call TIMBR assuming a uniform prior distribution and report the top ten posterior allelic series.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">results.uniform &lt;-<span class="st"> </span><span class="kw">TIMBR</span>(y, prior.D, prior.M.uniform, <span class="dt">verbose=</span>F, <span class="dt">samples=</span><span class="dv">100</span>, <span class="dt">samples.ml=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">as.matrix</span>(<span class="kw">head</span>(results.uniform<span class="op">$</span>p.M.given.y, <span class="dv">10</span>))</a></code></pre></div>
<pre><code>##                 [,1]
## 0,1,2,1,1,2,0,0 0.13
## 0,1,0,1,1,2,0,0 0.08
## 0,1,2,1,1,2,3,3 0.08
## 0,1,0,1,1,2,3,3 0.05
## 0,1,0,1,1,0,2,2 0.04
## 0,1,2,1,1,2,3,0 0.04
## 0,1,2,1,3,2,0,0 0.04
## 0,1,0,1,1,0,0,0 0.03
## 0,1,0,1,1,0,0,2 0.03
## 0,1,0,1,1,0,2,3 0.03</code></pre>
<p>The top allelic series configuration has three functional alleles (A,G,H vs. B,D,E vs. C,F), the biallelic contrast from the previous section is ranked fourth, and posterior certainty is generally low.</p>
</div>
<div id="modeling-the-allelic-series-with-a-chinese-restaurant-process-prior-distribution" class="section level2">
<h2>Modeling the allelic series with a Chinese restaurant process prior distribution</h2>
<p>A uniform distribution over allelic series implies a strong prior belief in an intermediate number of alleles, but this is unreasonable, for example, if we have a prior expectation that many allelic series are biallelic. TIMBR implements a flexible prior distribution over allelic series called a Chinese restaurant process (CRP). The CRP has a concentration parameter <span class="math inline">\(\alpha\)</span> that controls the prior number of functional alleles. At the limits, <span class="math inline">\(\alpha=0\)</span> implies a null model with only one functional allele, and <span class="math inline">\(\alpha=\infty\)</span> implies the haplotype-based model where all haplotypes are functionally distinct. The approach used in the manuscript places a gamma prior distribution on the concentration parameter with the following parameters.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">prior.M.crp &lt;-<span class="st"> </span>mcv.data<span class="op">$</span>prior.M<span class="op">$</span>crp</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">str</span>(prior.M.crp)</a></code></pre></div>
<pre><code>## List of 4
##  $ model.type       : chr &quot;crp&quot;
##  $ prior.alpha.type : chr &quot;gamma&quot;
##  $ prior.alpha.shape: num 1
##  $ prior.alpha.rate : num 2.33</code></pre>
<p>It is also possible to set <span class="math inline">\(\alpha\)</span> to a fixed value, see <code>mcv.data$prior.M$crp.fixed</code> for an example.</p>
<p>We call TIMBR using the CRP and this gamma prior distribution for the concentration parameter and report the top ten posterior allelic series.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">results.crp &lt;-<span class="st"> </span><span class="kw">TIMBR</span>(y, prior.D, prior.M.crp, <span class="dt">verbose=</span>F, <span class="dt">samples=</span><span class="dv">100</span>, <span class="dt">samples.ml=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">as.matrix</span>(<span class="kw">head</span>(results.crp<span class="op">$</span>p.M.given.y, <span class="dv">10</span>))</a></code></pre></div>
<pre><code>##                 [,1]
## 0,1,0,1,1,0,0,0 0.38
## 0,1,2,1,1,2,0,0 0.14
## 0,1,0,1,1,2,0,0 0.13
## 0,1,2,1,1,2,2,2 0.03
## 0,1,2,1,1,2,3,3 0.03
## 0,1,0,1,1,0,0,2 0.02
## 0,1,0,1,1,0,2,0 0.02
## 0,1,0,1,1,2,3,3 0.02
## 0,1,0,1,2,0,0,0 0.02
## 0,1,0,1,2,3,0,0 0.02</code></pre>
<p>The biallelic contrast from earlier is now the top posterior allelic series with over 50% probability. This is because our prior distribution places considerable weight on smaller numbers of functional alleles. We also visualize the haplotype effects against haplotype-based approach from earlier.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">TIMBR.plot.haplotypes</span>(results.crp, <span class="dt">TIMBR.output.bkgrd=</span>results.hap)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The haplotype effects using the CRP are again more certain, but they retain long tails that span much of the range of the effect estimates from the haplotype-based model.</p>
</div>
<div id="computing-the-prior-distribution-with-ewenss-sampling-formula" class="section level2">
<h2>Computing the prior distribution with Ewens’s sampling formula</h2>
<p>The CRP implictly assumes that the haplotypes are equally related and that the relationship between them is unknown. Specifically, Ewens’s sampling formula describes the CRP as the distribution over partitions (i.e. allelic series) induced by functional mutations on an unknown coalescent tree with the haplotypes at the leaves. TIMBR leverages this relationship to define a prior distribution for the allelic series that is conditional on a single tree (or set of trees), rather than an unknown coalescent tree.</p>
<p>The example data includes samples of coalescent trees at the causal locus for this QTL in <code>mcv.data$trees</code>. This is an object of class <code>multiphylo</code>, which is defined by the ‘ape’ package. We visualize the first tree sample using ‘ape’.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">library</span>(ape)</a>
<a class="sourceLine" id="cb29-2" title="2">trees &lt;-<span class="st"> </span>mcv.data<span class="op">$</span>trees</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="kw">plot.phylo</span>(trees[[<span class="dv">1</span>]])</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The tree indicates that haplotypes B,D,E are more closely related to each other and then the other haplotypes. Based on this relationship, and before observing any additional phenotype data, we intuitively expect that haplotypes B,D,E are more likely to be functionally identical and distinct from the other haplotypes. Ewens’s sampling formula formalizes this intuition by assuming that functional mutations occur on the tree in proportion to branch length. The function <code>ewenss.calc</code> enumerates all possible combinations of mutated tree branch, calculates prior probabilities, and returns a prior distribution over allelic series that is conditional on this tree.</p>
<p>We use the same prior on the concentration parameter <span class="math inline">\(\alpha\)</span> (in this context, the functional mutation rate on the branches) as before, examine the output, and we display the ten allelic series with the highest prior probability.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">prior.alpha &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;gamma&quot;</span>, </a>
<a class="sourceLine" id="cb30-2" title="2">                    <span class="dt">shape=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb30-3" title="3">                    <span class="dt">rate=</span><span class="fl">2.333415</span>)</a>
<a class="sourceLine" id="cb30-4" title="4">prior.M.tree<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">ewenss.calc</span>(trees[[<span class="dv">1</span>]], prior.alpha)</a>
<a class="sourceLine" id="cb30-5" title="5"><span class="kw">str</span>(prior.M.tree<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## List of 4
##  $ model.type: chr &quot;list&quot;
##  $ M.IDs     : chr [1:610] &quot;0,0,0,0,0,0,0,0&quot; &quot;0,1,0,1,1,0,0,0&quot; &quot;0,1,0,1,1,0,2,0&quot; &quot;0,0,0,0,0,0,1,0&quot; ...
##  $ ln.probs  : num [1:610] -0.596 -1.849 -3.112 -3.118 -3.527 ...
##  $ hash.names: logi TRUE</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">data.frame</span>(<span class="dt">M=</span>prior.M.tree<span class="fl">.1</span><span class="op">$</span>M.IDs[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">post.prob=</span><span class="kw">exp</span>(prior.M.tree<span class="fl">.1</span><span class="op">$</span>ln.probs[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]))</a></code></pre></div>
<pre><code>##                  M  post.prob
## 1  0,0,0,0,0,0,0,0 0.55099481
## 2  0,1,0,1,1,0,0,0 0.15732748
## 3  0,1,0,1,1,0,2,0 0.04449096
## 4  0,0,0,0,0,0,1,0 0.04423335
## 5  0,0,0,0,0,1,0,0 0.02938894
## 6  0,1,0,1,1,1,1,0 0.02432615
## 7  0,1,0,1,1,2,3,0 0.02339047
## 8  0,1,0,1,1,2,0,0 0.01993024
## 9  0,1,0,1,1,2,2,0 0.01638841
## 10 0,1,0,1,1,0,1,0 0.01336181</code></pre>
<p>As expected, there is now considerable prior weight given to allelic series that results from functional mutations on longer branches of the tree. It is possible (though somewhat computationally intensive) to compute the prior distribution for all the samples in <code>trees</code> and average them to accomodate uncertainty in the tree. We provide code for this here, and it is also precomputed in <code>mcv.data$prior.M$list</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># trees.prior &lt;- lapply(trees, ewenss.calc, prior.alpha=prior.alpha)</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co"># trees.prior &lt;- unlist(lapply(trees.prior, function(x){ln.probs &lt;- x$ln.probs; </span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co">#                                                       names(ln.probs) &lt;- x$M.IDs; </span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co">#                                                       ln.probs}))</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="co"># trees.prior &lt;- tapply(trees.prior, names(trees.prior), matrixStats::logSumExp) - log(length(trees))</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="co"># prior.M.trees &lt;- list(model.type=&quot;list&quot;, </span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="co">#                       M.IDs=names(trees.prior), </span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="co">#                       ln.probs=as.numeric(unname(trees.prior)), </span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="co">#                       hash.names=T)</span></a>
<a class="sourceLine" id="cb34-10" title="10"></a>
<a class="sourceLine" id="cb34-11" title="11">prior.M.trees &lt;-<span class="st"> </span>mcv.data<span class="op">$</span>prior.M<span class="op">$</span>list</a></code></pre></div>
<p>We can also use <code>ewenss.calc</code> to precompute the prior distribution under the CRP, alternatively formatted as this list-type input. Calling TIMBR with this prior is equivalent to using <code>prior.M.crp</code> from earlier.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">prior.M.crp.list &lt;-<span class="st"> </span><span class="kw">ewenss.calc</span>(<span class="dv">8</span>, prior.alpha)</a></code></pre></div>
<p>To convince yourself of the relationship between the CRP and Ewens’s sampling formula, try sampling a collection of random coalescent trees using the code below, compute and average their prior distributions as we just described, and compare the result with <code>prior.M.crp.list</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># trees.coal &lt;- replicate(1000, rcoal(8, LETTERS[1:8]), simplify=F)</span></a></code></pre></div>
</div>
<div id="modeling-the-allelic-series-with-a-tree-informed-prior-distribution" class="section level2">
<h2>Modeling the allelic series with a tree-informed prior distribution</h2>
<p>It is straightforward to call TIMBR with a tree-informed prior distribution and reporting the posterior allelic series.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">results.crp.trees &lt;-<span class="st"> </span><span class="kw">TIMBR</span>(y, prior.D, prior.M.trees, <span class="dt">verbose=</span>F, <span class="dt">samples=</span><span class="dv">1000</span>, <span class="dt">samples.ml=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">as.matrix</span>(<span class="kw">head</span>(results.crp.trees<span class="op">$</span>p.M.given.y, <span class="dv">10</span>))</a></code></pre></div>
<pre><code>##                  [,1]
## 0,1,0,1,1,0,0,0 0.646
## 0,1,0,1,1,2,0,0 0.143
## 0,1,0,1,1,0,2,0 0.100
## 0,1,0,1,1,2,3,0 0.068
## 0,1,0,1,1,2,2,0 0.012
## 0,1,0,1,1,2,3,4 0.004
## 0,1,0,1,1,0,0,2 0.003
## 0,1,2,1,1,3,0,0 0.003
## 0,1,2,1,1,3,4,0 0.003
## 0,1,0,1,1,0,2,3 0.002</code></pre>
<p>Posterior certainty is higher relative to the CRP because we have introduced additional prior information about haplotype relatedness. We calculate a lnBF in favor of this tree-informed prior against the CRP, which implictly assumes an unknown coalescent tree.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">results.crp.trees<span class="op">$</span>ln.BF <span class="op">-</span><span class="st"> </span>results.crp<span class="op">$</span>ln.BF</a></code></pre></div>
<pre><code>## [1] 4.501711</code></pre>
</div>
<div id="visualizing-the-prior-distribution-of-number-of-alleles" class="section level2">
<h2>Visualizing the prior distribution of number of alleles</h2>
<p>Earlier, we mentioned that our specified CRP prior distribution favors fewer alleles relative to the uniform prior distribution. Here, we provide code to visualize the prior distribution of number of alleles using the CRP. Try changing the parameters of the gamma prior for <span class="math inline">\(\alpha\)</span> (or fixing <span class="math inline">\(\alpha\)</span> to a single value) and see how the prior distribution changes.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">prior.alpha &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;gamma&quot;</span>, <span class="dt">shape=</span><span class="dv">1</span>, <span class="dt">rate=</span><span class="fl">2.333415</span>)</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="co"># prior.alpha &lt;- list(type=&quot;fixed&quot;, alpha=1)</span></a>
<a class="sourceLine" id="cb41-3" title="3"></a>
<a class="sourceLine" id="cb41-4" title="4">prior.M.crp.list &lt;-<span class="st"> </span><span class="kw">ewenss.calc</span>(<span class="dv">8</span>, prior.alpha)</a>
<a class="sourceLine" id="cb41-5" title="5">number.alleles &lt;-<span class="st"> </span><span class="kw">sapply</span>(prior.M.crp.list<span class="op">$</span>M.IDs, </a>
<a class="sourceLine" id="cb41-6" title="6">                         <span class="cf">function</span>(x){<span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">strsplit</span>(x, <span class="dt">split=</span><span class="st">&quot;,&quot;</span>))))<span class="op">+</span><span class="dv">1</span>})</a>
<a class="sourceLine" id="cb41-7" title="7">prior.number.alleles.uniform &lt;-<span class="st"> </span><span class="kw">table</span>(number.alleles) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(number.alleles)</a>
<a class="sourceLine" id="cb41-8" title="8">prior.number.alleles.crp &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">tapply</span>(prior.M.crp.list<span class="op">$</span>ln.probs, number.alleles, </a>
<a class="sourceLine" id="cb41-9" title="9">                                       matrixStats<span class="op">::</span>logSumExp))</a>
<a class="sourceLine" id="cb41-10" title="10"></a>
<a class="sourceLine" id="cb41-11" title="11"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, prior.number.alleles.crp, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lty=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb41-12" title="12">     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">ylab=</span><span class="st">&quot;Prior Probability&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Number of Alleles&quot;</span>, </a>
<a class="sourceLine" id="cb41-13" title="13">     <span class="dt">main=</span><span class="st">&quot;Prior Distribution of Alleles&quot;</span>)</a>
<a class="sourceLine" id="cb41-14" title="14"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, prior.number.alleles.crp, <span class="dt">lty=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb41-15" title="15"><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, prior.number.alleles.crp, <span class="dt">pch=</span><span class="dv">22</span>, <span class="dt">bg=</span><span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb41-16" title="16"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, prior.number.alleles.uniform, <span class="dt">lty=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;darkcyan&quot;</span>)</a>
<a class="sourceLine" id="cb41-17" title="17"><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, prior.number.alleles.uniform, <span class="dt">pch=</span><span class="dv">22</span>, <span class="dt">bg=</span><span class="st">&quot;darkcyan&quot;</span>)</a>
<a class="sourceLine" id="cb41-18" title="18"></a>
<a class="sourceLine" id="cb41-19" title="19"><span class="kw">legend</span>(<span class="dv">1</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Uniform&quot;</span>, <span class="st">&quot;CRP&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;darkcyan&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="dt">lty=</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="approximating-bayes-factors-for-alternative-prior-distributions-from-previous-results" class="section level2">
<h2>Approximating Bayes factors for alternative prior distributions from previous results</h2>
<p>It is possible to approximate lnBFs for alternative allelic series prior distributions using the results of a previous TIMBR run and the <code>TIMBR.approx</code> function. This is useful for analyses that must be repeated many times for a single locus (e.g. evaluating multiple variants for merge analysis), or more generally, for quickly evaluating evidence in favor of alternative priors. For illustration, we approximate the lnBF for all possible biallelic contrasts using our CRP results, and we compare these with the biallelic result we generated earlier.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">TIMBR.approx</span>(results.crp, <span class="st">&quot;merge&quot;</span>)</a></code></pre></div>
<pre><code>## 0,1,0,1,1,0,0,0 
##        37.65579</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">results.biallelic<span class="op">$</span>ln.BF</a></code></pre></div>
<pre><code>## [1] 37.68054</code></pre>
<p>Note that this is only an approximation. In this case, only one biallelic series was observed in the CRP posterior, so approximations for all other biallelic contrasts underflow and are not reported.</p>
</div>
<div id="other-options" class="section level2">
<h2>Other options</h2>
<p>The <code>TIMBR</code> function has several other useful options. Covariates can be specified using the <code>Z</code> matrix; just make sure that the first column of the matrix is a vector of ones. It is also possible to use strain means for <code>y</code> and specify the number of replicates using vector <code>W</code>. Finally, it is possible to control shrinkage in the allele effects by varying <code>prior.phi.v</code>; see the manuscript for a description of the hyperparameter <span class="math inline">\(\nu\)</span>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
